<div class="register-container min-vh-100 d-flex align-items-center py-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <!-- Card -->
        <div class="card register-card border-0 shadow-lg">
          <!-- Header -->
          <div class="card-header text-white text-center py-5">
            <a routerLink="/" class="brand-logo text-decoration-none">
              <h1 class="fw-bold display-6 mb-3"><i class="bi bi-laptop me-3"></i>E-Tech Store</h1>
            </a>
            <p class="opacity-75 mb-0 fs-5">Rejoignez notre communauté</p>
          </div>

          <!-- Body -->
          <div class="card-body p-4 p-md-5">
            <!-- Steps -->
            <div class="step-indicator">
              @for (step of steps; track step.number; let i = $index) {
              <div
                class="step"
                [class.active]="currentStep() === step.number"
                [class.completed]="currentStep() > step.number"
              >
                <span>{{ step.number }}</span>
                <div class="step-label">{{ step.label }}</div>
              </div>
              }
            </div>

            <!-- Step 1 -->
            @if (currentStep() === 1) {
            <div class="form-section active">
              <h3 class="mb-4 fw-bold">Informations personnelles</h3>

              <div class="row g-3">
                <div class="col-md-6">
                  <label class="form-label fw-semibold">Prénom *</label>
                  <input
                    [(ngModel)]="firstName"
                    type="text"
                    class="form-control form-control-lg"
                    placeholder="Votre prénom"
                  />
                  <div class="invalid-feedback">Le prénom est requis</div>
                </div>

                <div class="col-md-6">
                  <label class="form-label fw-semibold">Nom *</label>
                  <input
                    type="text"
                    [(ngModel)]="lastName"
                    class="form-control form-control-lg"
                    placeholder="Votre nom"
                  />
                  <div class="invalid-feedback">Le nom est requis</div>
                </div>

                <div class="col-12">
                  <label class="form-label fw-semibold">
                    <i class="bi bi-telephone me-2"></i>Téléphone
                  </label>
                  <input
                    type="tel"
                    [(ngModel)]="phone"
                    class="form-control form-control-lg"
                    placeholder=""
                  />
                </div>
              </div>

              <div class="d-flex justify-content-between mt-5">
                <button type="button" class="btn btn-outline-secondary px-4" disabled>
                  <i class="bi bi-arrow-left me-2"></i>Précédent
                </button>
                <button
                  type="button"
                  class="btn btn-primary px-4"
                  (click)="nextStep()"
                  [disabled]="!isStep1Valid()"
                >
                  Suivant <i class="bi bi-arrow-right ms-2"></i>
                </button>
              </div>
            </div>
            }

            <!-- Step 2 -->
            @if (currentStep() === 2) {
            <div class="form-section active">
              <h3 class="mb-4 fw-bold">Création du compte</h3>

              <div class="mb-4">
                <label class="form-label fw-semibold">
                  <i class="bi bi-envelope me-2"></i>Email *
                </label>
                <input
                  [(ngModel)]="email"
                  type="email"
                  class="form-control form-control-lg"
                  placeholder="votre@email.com"
                />
                <div class="invalid-feedback">L'email est requis</div>
                <div class="invalid-feedback">Email invalide</div>
              </div>

              <div class="mb-4">
                <label class="form-label fw-semibold">
                  <i class="bi bi-lock me-2"></i>Mot de passe *
                </label>
                <div class="input-group">
                  <input
                    [(ngModel)]="password"
                    [type]="showPassword() ? 'text' : 'password'"
                    class="form-control form-control-lg"
                    placeholder="Votre mot de passe"
                    (input)="checkPasswordStrength()"
                  />
                  <button
                    class="btn btn-outline-secondary"
                    type="button"
                    (click)="togglePasswordVisibility()"
                  >
                    <i
                      class="bi"
                      [class.bi-eye]="!showPassword()"
                      [class.bi-eye-slash]="showPassword()"
                    ></i>
                  </button>
                </div>

                <!-- Password Strength -->
                <div class="mt-3">
                  <div class="progress">
                    <div
                      class="progress-bar"
                      [class]="passwordStrengthClass()"
                      [style.width.%]="passwordStrengthPercentage()"
                    ></div>
                  </div>
                  <div class="password-strength mt-2"></div>
                </div>

                <div class="invalid-feedback">Mot de passe requis</div>

                <div class="invalid-feedback">Minimum 6 caractères</div>
              </div>

              <div class="mb-4">
                <label class="form-label fw-semibold">
                  <i class="bi bi-lock-fill me-2"></i>Confirmer *
                </label>
                <input
                  type="password"
                  class="form-control form-control-lg"
                  placeholder="Retapez votre mot de passe"
                />

                <div class="invalid-feedback">Les mots de passe ne correspondent pas</div>
              </div>

              <div class="mb-4">
                <div class="form-check mb-3">
                  <input class="form-check-input" type="checkbox" id="terms" />
                  <label class="form-check-label" for="terms">
                    J'accepte les
                    <a href="#" class="text-primary text-decoration-none">CGU</a>
                    et la
                    <a href="#" class="text-primary text-decoration-none"
                      >Politique de confidentialité</a
                    >
                    *
                  </label>

                  <div class="invalid-feedback d-block">Vous devez accepter les conditions</div>
                </div>

                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="newsletter" />
                  <label class="form-check-label" for="newsletter">
                    Recevoir les offres promotionnelles
                  </label>
                </div>
              </div>

              <div class="d-flex justify-content-between">
                <button type="button" class="btn btn-outline-secondary px-4" (click)="prevStep()">
                  <i class="bi bi-arrow-left me-2"></i>Précédent
                </button>
                <button
                  type="button"
                  class="btn btn-primary px-4"
                  (click)="nextStep()"
                  [disabled]="!isStep2Valid()"
                >
                  Suivant <i class="bi bi-arrow-right ms-2"></i>
                </button>
              </div>
            </div>
            }

            <!-- Step 3 -->
            @if (currentStep() === 3) {
            <div class="form-section active">
              @if (registrationSuccess()) {
              <!-- Success Message -->
              <div class="text-center py-5">
                <div class="success-icon mx-auto mb-4">
                  <i class="bi bi-check-lg"></i>
                </div>
                <h3 class="fw-bold mb-3">Compte créé avec succès !</h3>
                <p class="text-muted mb-4">Un email de confirmation a été envoyé à email.value</p>
                <div class="d-grid gap-2 col-lg-6 mx-auto">
                  <a routerLink="/login" class="btn btn-primary btn-lg">Se connecter</a>
                  <a routerLink="/" class="btn btn-outline-primary">Accueil</a>
                </div>
              </div>
              } @else {
              <!-- Summary -->
              <h3 class="mb-4 fw-bold">Récapitulatif</h3>

              <div class="card mb-4 border-0 bg-light">
                <div class="card-body">
                  <h5 class="card-title mb-3">
                    <i class="bi bi-person-badge me-2"></i>Vos informations
                  </h5>
                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <h6 class="text-muted mb-1">Nom complet</h6>
                      <p class="fw-bold mb-0">firstName.value lastName.value</p>
                    </div>
                    <div class="col-md-6 mb-3">
                      <h6 class="text-muted mb-1">Email</h6>
                      <p class="fw-bold mb-0">email.value</p>
                    </div>

                    <div class="col-md-6 mb-3">
                      <h6 class="text-muted mb-1">Téléphone</h6>
                      <p class="fw-bold mb-0">phone.value</p>
                    </div>

                    <div class="col-md-6 mb-3">
                      <h6 class="text-muted mb-1">Date de naissance</h6>
                      <p class="fw-bold mb-0"></p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Benefits -->
              <div class="mb-5">
                <h5 class="mb-3">Avantages exclusifs :</h5>
                <div class="row g-3">
                  @for (benefit of benefits; track benefit.title) {
                  <div class="col-md-4">
                    <div class="benefit-item p-3 h-100">
                      <div class="benefit-icon mb-3">
                        <i class="bi" [class]="benefit.icon"></i>
                      </div>
                      <h6 class="fw-bold mb-2">{{ benefit.title }}</h6>
                      <p class="text-muted mb-0 small">{{ benefit.description }}</p>
                    </div>
                  </div>
                  }
                </div>
              </div>

              <!-- Actions -->
              <div class="d-flex justify-content-between">
                <button type="button" class="btn btn-outline-secondary px-4" (click)="prevStep()">
                  <i class="bi bi-arrow-left me-2"></i>Modifier
                </button>
                <button
                  type="button"
                  class="btn btn-success btn-lg px-5"
                  (click)="register()"
                  [disabled]="isRegistering()"
                >
                  @if (isRegistering()) {
                  <span class="spinner-border spinner-border-sm me-2"></span>
                  Création... } @else {
                  <i class="bi bi-check-lg me-2"></i>Créer mon compte }
                </button>
              </div>
              }
            </div>
            }

            <!-- Social Login -->
            <div class="text-center mt-5 pt-4 border-top">
              <p class="text-muted mb-3">Ou inscrivez-vous avec</p>
              <div class="d-flex justify-content-center gap-3">
                <button type="button" class="btn btn-outline-primary rounded-circle social-btn">
                  <i class="bi bi-google"></i>
                </button>
                <button type="button" class="btn btn-outline-primary rounded-circle social-btn">
                  <i class="bi bi-facebook"></i>
                </button>
                <button type="button" class="btn btn-outline-primary rounded-circle social-btn">
                  <i class="bi bi-twitter"></i>
                </button>
              </div>
            </div>

            <!-- Login Link -->
            <div class="text-center mt-4 pt-3">
              <p class="mb-0">
                Déjà un compte ?
                <a [routerLink]="['/login']" class="text-primary fw-bold text-decoration-none">
                  Connectez-vous
                </a>
              </p>
              <a [routerLink]="['/']" class="btn btn-link text-decoration-none mt-2">
                <i class="bi bi-arrow-left me-1"></i> Retour à l'accueil
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
