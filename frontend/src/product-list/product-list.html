<div class="container my-5">
  <!-- Header with product count -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold mb-0 text-dark">
      <i class="bi bi-box-seam me-2"></i>Products
      <span class="badge bg-primary rounded-pill ms-2">{{ products().length }}</span>
    </h3>
  </div>

  <div class="row g-3">
    <div class="col-12 col-sm-6 col-md-4 col-lg-3" *ngFor="let product of products()">
      <div
        class="card product-card h-100 border-0 shadow-sm"
        [routerLink]="['/product-item', product.id]"
      >
        <!-- Product Image Container -->
        <div class="position-relative overflow-hidden" style="height: 180px">
          <!-- Main Image -->
          <img
            [src]="product.pictures[0]?.url || 'assets/images/placeholder.jpg'"
            class="card-img-top h-100 w-100 object-fit-cover"
            [alt]="product.product_name"
            (error)="$event.target.src = 'assets/images/placeholder.jpg'"
          />

          <!-- Stock Badge -->
          <div class="position-absolute top-0 start-0 m-2">
            <span class="badge" [ngClass]="product.stock > 0 ? 'bg-success' : 'bg-danger'">
              {{ product.stock > 0 ? 'In Stock' : 'Out of Stock' }}
            </span>
          </div>

          <!-- Quick View Button -->
          <div class="position-absolute top-0 end-0 m-2">
            <button
              class="btn btn-light btn-sm rounded-circle shadow-sm"
              title="Quick View"
              style="width: 32px; height: 32px; padding: 0"
            >
              <i class="bi bi-eye"></i>
            </button>
          </div>
        </div>

        <!-- Card Body -->
        <div class="card-body d-flex flex-column p-3">
          <!-- Product Name -->
          <h6 class="fw-semibold mb-2 text-dark" style="font-size: 0.95rem; line-height: 1.3">
            {{ product.product_name }}
          </h6>

          <!-- Product Description -->
          <p
            class="text-muted small flex-grow-1 mb-3"
            style="font-size: 0.85rem; line-height: 1.4; min-height: 40px"
          >
            {{ product.product_description || 'No description available' }}
          </p>

          <!-- Price and Stock -->
          <div class="d-flex justify-content-between align-items-center mt-auto">
            <!-- Price -->
            <span class="fw-bold text-primary" style="font-size: 1.1rem">
              {{ product.prix }} DT
            </span>

            <!-- Stock Indicator -->
            <div class="d-flex align-items-center">
              <div
                class="me-2"
                [ngClass]="{
                  'text-success': product.stock > 0,
                  'text-danger': product.stock === 0
                }"
              >
                <i
                  class="bi"
                  [ngClass]="product.stock > 0 ? 'bi-check-circle-fill' : 'bi-x-circle-fill'"
                >
                </i>
              </div>
              <small class="text-muted">
                {{ product.stock > 0 ? product.stock + ' left' : 'Sold out' }}
              </small>
            </div>
          </div>

          <!-- Add to Cart Button -->
          <button
            class="btn mt-3 w-100"
            [disabled]="product.stock === 0"
            [ngClass]="{ 'btn-primary': product.stock > 0, 'btn-secondary': product.stock === 0 }"
          >
            <i class="bi" [ngClass]="product.stock > 0 ? 'bi-cart-plus me-1' : 'bi-cart-x me-1'">
            </i>
            {{ product.stock > 0 ? 'Add to Cart' : 'Out of Stock' }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
